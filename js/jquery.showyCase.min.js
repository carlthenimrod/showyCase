(function(b,r,s,q){"function"!==typeof Object.create&&(Object.create=function(a){function b(){}b.prototype=a;return new b});b.plugin=function(a,d){b.fn[a]=function(c){return this.each(function(){b.data(this,a)||b.data(this,a,Object.create(d).init(c,this))})}};b.plugin("showyCase",{init:function(a,d){var c=this;c.config=b.extend({},c.defaults,a);c.elem=d;c.$elem=b(d);b.when(c.load()).then(function(){b.when(c.build()).then(function(){c.events();c.modules.ctn.fadeIn(c.config.speedLoad)},function(){alert("Error: Failed to build HTML.")})},
function(){alert("Error: Failed to load data.")});return c},defaults:{ajaxCache:!1,ajaxDataType:"json",ajaxDataUrl:"json/jquery.single.json",classCtn:"sc-ctn",classCtrl:"sc-ctrl",classPrev:"sc-prev",classNext:"sc-next",classThumbs:"sc-thumbs",onItemClick:!1,html5:!0,multiJSON:!1,pageShow:18,pageStart:0,pathFull:!1,pathRoot:"img/",pathThumbs:"img/thumbs/",speedLoad:300,speedTransition:150},load:function(){var a=this,d=b.Deferred();b.ajax({cache:a.config.ajaxCache,dataType:a.config.ajaxDataType,url:a.config.ajaxDataUrl}).then(function(c){a.config.multiJSON?
(a.categories=c.categories,b.when(a.findData()).then(function(){a.items=a.utils.findAllItems(a.data);d.resolve()})):(a.data=c.items,a.items=a.utils.findAllItems(a.data),d.resolve())},function(){d.reject()});return d.promise()},build:function(){var a=this,d=b.Deferred();b.when(a.render()).then(function(){a.$elem.fadeIn(a.config.speedLoad,function(){d.resolve()})},function(){d.reject()});return d.promise()},events:function(){var a=this;a.modules.ctrlPrev.on("click",function(){if((!a.animating||"pending"!==
a.animating.state())&&0!==a.pages.current)--a.pages.current,a.eventRefreshThumbs()});a.modules.ctrlNext.on("click",function(){if((!a.animating||"pending"!==a.animating.state())&&a.pages.current!==a.pages.total-1)++a.pages.current,a.eventRefreshThumbs()})},eventRefreshThumbs:function(){var a=this,d,c,f,g,l=[],j,h,e;a.animating=b.Deferred();a.modules.thumbs.fadeOut(a.config.speedTransition,function(){a.modules.thumbs.empty();j=a.pages.current*a.pages.show;h=j+a.pages.show;e=a.items.slice(j,h);d=b("<ul>");
var k,m,n,p;k=0;for(m=e.length;k<m;++k)p=a.config.pathThumbs?a.config.pathThumbs+e[k].img:a.config.pathRoot+e[k].img,"blurbGallery"==a.config.onImgClick?(selected_cat=a.utils.formatText(e[k].cat),selected_img=a.utils.formatText(e[k].title),n="gallery.php?cat="+selected_cat+"&img="+selected_img):n=a.config.pathRoot+e[k].img,c=b("<li>"),g=b("<a/>",{alt:e[k].title,title:e[k].title}).attr("href",n),f=b("<img/>",{alt:e[k].title,title:e[k].title}).attr("src",p),g.append(f),c.append(g),d.append(c),l.push(p);
a.utils.preload(l).done(function(){a.modules.thumbs.append(d);a.modules.thumbs.fadeIn(a.config.speedTransition,function(){a.animating.resolve()})})})},render:function(){var a=[],d=b.Deferred();this.modules={};a.push(this.renderContainer());a.push(this.renderControls());a.push(this.renderThumbs());b.when.apply(this,a).then(function(){d.resolve()},function(){d.reject()});return d.promise()},renderContainer:function(){this.modules.ctn=this.config.html5?b("<section>"):b("<div>");this.modules.ctn.attr({"class":this.config.classCtn});
this.$elem.append(this.modules.ctn)},renderControls:function(){this.modules.ctrl=this.config.html5?b("<section>"):b("<div>");this.modules.ctrl.attr({"class":this.config.classCtrl});this.modules.ctrlPrev=b("<div>",{alt:"Previous","class":this.config.classPrev,title:"Previous"});this.modules.ctrlNext=b("<div>",{alt:"Next","class":this.config.classNext,title:"Next"});this.modules.ctrl.append(this.modules.ctrlPrev);this.modules.ctrl.append(this.modules.ctrlNext);this.modules.ctn.append(this.modules.ctrl)},
renderThumbs:function(){var a=this,d=b.Deferred(),c,f,g,l,j=[],h;a.createPages();h=a.pages.current*a.pages.show;h=a.items.slice(h,h+a.pages.show);a.modules.thumbs=a.config.html5?b("<nav>"):b("<div>");a.modules.thumbs.attr({"class":a.config.classThumbs});a.modules.ctn.append(a.modules.thumbs);c=b("<ul>");var e,k,m;e=0;for(k=h.length;e<k;++e)m=a.config.pathThumbs?a.config.pathThumbs+h[e].img:a.config.pathRoot+h[e].img,"blurbGallery"==a.config.onImgClick?(g=a.utils.formatText(h[e].cat),f=a.utils.formatText(h[e].title),
g="gallery.php?cat="+g+"&img="+f):g=a.config.pathRoot+h[e].img,f=b("<li>"),l=b("<a/>",{alt:h[e].title,title:h[e].title}).attr("href",g),g=b("<img/>",{alt:h[e].title,title:h[e].title}).attr("src",m),l.append(g),f.append(l),c.append(f),j.push(m);a.utils.preload(j).done(function(){a.modules.thumbs.append(c);d.resolve()});return d.promise()},findData:function(){var a=this,d=[],c=b.Deferred(),f,g;a.data=[];f=0;for(g=a.categories.length;f<g;++f)(function(){var c=b.Deferred();d.push(c);b.ajax({async:!1,
cache:a.config.ajaxCache,dataType:a.config.ajaxDataType,url:"json/"+a.utils.formatText(a.categories[f].id)+".json"}).then(function(b){a.data.push(b.items);c.resolve()},function(){c.reject()})})();b.when.apply(this,d).done(c.resolve);return c.promise()},createPages:function(){this.pages={current:this.config.pageStart,show:this.config.pageShow,count:this.items.length,total:q};this.pages.total=Math.ceil(this.pages.count/this.pages.show)},utils:{findAllItems:function(a){var b,c,f,g=[],l;b=0;for(c=a.length;b<
c;++b){l=a[b].id;f=a[b].item;for(var j=void 0,h=void 0,j=0,h=f.length;j<h;++j)f[j].cat=l,g.push(f[j])}return g},formatText:function(a){a=a.toLowerCase();a=a.replace(/ /g,"_");a=a.replace(/&/g,"and");return a=a.replace(/[^a-z0-9_]/g,"")},preload:function(a){var d=b.Deferred(),c=[],f,g,l;b.isArray(a)||(a=[a]);g=a.length;for(var j=0;j<g;j++)l=b.Deferred(),f=b("<img />"),f.load(l.resolve),f.error(l.resolve),c.push(l),f.get(0).src=a[j];b.when.apply(this,c).done(d.resolve);return d.promise()}}})})(jQuery,
window,document);